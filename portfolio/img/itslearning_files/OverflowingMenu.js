function OverflowingMenu(){function y(a){var d=$("#"+g).addClass(b.settings.cssClasses.moreMenu),e=0;a.each(function(a,f){a=$(f);f=a.outerWidth(!0);d.append(a);a.is(r)||f>e&&(e=f)});a=c.offset().left;t.innerWidth()-a<=e&&(a=a+m-e);d.css("left",a+"px")}function u(){m=c.outerWidth(!0);var a=0<k.width()-p;p=k.width();a&&($("#"+g).children().each(function(a,d){$(d).insertBefore(c)}),c.hide());var d=Number.POSITIVE_INFINITY,e=k.width()-10,b=m;l.each(function(a,c){c=$(c).outerWidth(!0);if(a>=n||b+c>e||
a<l.length-1&&b+c+m>e)return d=a,!1;b+=c});0<l.length-d&&window.innerWidth>v&&(c.css({display:"inline-block"}),y(l.filter(":gt("+(d-1)+")")))}function z(){q&&clearTimeout(q);q=setTimeout(u,w)}function x(a){var d=$("#"+g),c=$(this.parentElement).children().first();if(a.keyCode===CommonConstants.keyCodes.tab){var b=a.target.parentElement,f=b.parentElement;if(null==b.nextElementSibling||b.nextElementSibling.classList.contains("viewas-menu-header")||a.shiftKey)a.shiftKey?$(f).find("a:visible").first().is(":focus")&&
($(f).find("a:visible").last().focus(),a.preventDefault()):($(f).find("a:visible").first().focus(),a.preventDefault())}a.keyCode===CommonConstants.keyCodes.escape&&(d.hide(),c.attr("aria-expanded",!1),d.off(h+" keydown",x),c.focus());a.type!==h&&a.which!==CommonConstants.keyCodes.enter||setTimeout(function(){d.hide();c.attr("aria-expanded",!1)},0);a.stopPropagation()}function A(a){if(a.type===h||a.which===CommonConstants.keyCodes.enter){var d=$("#"+g),b=c.first("> .l-main-menu-lnk");"false"===$(".c-messages-popup").attr("aria-hidden")&&
$(".c-messages__overlay").click();d.toggle();d.is(":visible")?(b.children().first().attr("aria-expanded",!0),d.find("a").first().focus(),d.on("keydown "+h,x),a.preventDefault()):b.children().first().attr("aria-expanded",!1)}}var b=this,t=$(window),k,l,c,m,g,r,h,q,w,n,p,v;b.initialize=function(){h="click";w=b.settings.windowResizeTimeoutInMilliseconds;k=b.controls.mainMenu;l=b.controls.mainMenuItems;c=b.controls.moreButton;g=b.settings.moreMenuId;r=b.settings.moreMenuItemsIgnoreClass||"";n=b.settings.maxNumberOfMainMenuItems;
v=b.settings.minScreenWidth||0;p=k.width();"undefined"==typeof n&&(n=Number.POSITIVE_INFINITY);c.append('<ul id="'+g+'" style="display:none;position:absolute;"></ul>');c.hide();u();t.resize(z);c.first("> .l-main-menu-lnk").on(h+" keydown",A);$(document).on(h+" "+CommonTriggers.clickInInnerFrame,function(a){var b=$("#"+g),e=$(this.parentElement).children().first();b.is(":visible")&&(a=$(a.target),c.find("> .l-main-menu-lnk").is(a)||c.find("> .l-main-menu-lnk").children().is(a)||(b.hide(),e.attr("aria-expanded",
!1)))})};return b};
